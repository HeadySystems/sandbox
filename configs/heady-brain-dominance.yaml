# HEADY_BRAND:BEGIN
# ╔══════════════════════════════════════════════════════════════════╗
# ║  ██╗  ██╗███████╗ █████╗ ██████╗ ██╗   ██╗                     ║
# ║  ██║  ██║██╔════╝██╔══██╗██╔══██╗╚██╗ ██╔╝                     ║
# ║  ███████║█████╗  ███████║██║  ██║ ╚████╔╝                      ║
# ║  ██╔══██║██╔══╝  ██╔══██║██║  ██║  ╚██╔╝                       ║
# ║  ██║  ██║███████╗██║  ██║██████╔╝   ██║                        ║
# ║  ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═════╝    ╚═╝                        ║
# ║                                                                  ║
# ║  ∞ SACRED GEOMETRY ∞  Organic Systems · Breathing Interfaces    ║
# ║  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  ║
# ║  FILE: configs/heady-brain-dominance.yaml                                                    ║
# ║  LAYER: config                                                  ║
# ╚══════════════════════════════════════════════════════════════════╝
# HEADY_BRAND:END

# HeadyBrain Dominance & Service Enforcement Policy
# 
# This configuration ensures HeadyBrain is used 100% of the time and all Heady services
# remain 100% functional unless explicitly directed otherwise.

version: "1.0.0"
policy_name: "HeadyBrain-Dominance"
enforcement_level: "absolute"  # absolute, strict, permissive

# ============================================================================
# HEADY BRAIN DOMINANCE CONFIGURATION
# ============================================================================
heady_brain:
  # Always use HeadyBrain for all decision-making
  dominance_mode: 
    enabled: true
    priority: "supreme"  # supreme, critical, high, medium, low
    override_all_other_services: true
    veto_power: true  # Can override any other service decision
    
  # Brain service endpoints (primary + failover)
  endpoints:
    primary:
      url: "https://headyio.com/api/brain"
      priority: 1
      timeout: 5000ms
      retries: 3
    secondary:
      url: "https://headyio.com/api/brain-backup"
      priority: 2
      timeout: 10000ms
      retries: 5
    tertiary:
      url: "https://headyio.com/api/brain-emergency"
      priority: 3
      timeout: 15000ms
      retries: 10
      
  # Brain availability requirements
  availability:
    target_uptime: "100.0%"
    minimum_uptime: "99.9%"
    health_check_interval: 10s
    failure_threshold: 2  # consecutive failures before failover
    recovery_threshold: 5  # consecutive successes before recovery

# ============================================================================
# SERVICE ENFORCEMENT POLICIES
# ============================================================================
service_enforcement:
  # All services must use HeadyBrain
  brain_mandatory_for:
    - "decision_making"
    - "task_routing"
    - "resource_allocation"
    - "priority_setting"
    - "error_handling"
    - "performance_optimization"
    - "security_decisions"
    - "deployment_decisions"
    - "code_generation"
    - "analysis_tasks"
    
  # Services that must always be active
  mandatory_services:
    - name: "heady-brain"
      criticality: "supreme"
      auto_restart: true
      health_check: "/api/brain/health"
      fallback_endpoints: ["secondary", "tertiary"]
      
    - name: "heady-manager"
      criticality: "critical"
      auto_restart: true
      health_check: "/api/health"
      brain_integration: "required"
      
    - name: "heady-conductor"
      criticality: "critical"
      auto_restart: true
      health_check: "/health"
      brain_integration: "required"
      
    - name: "heady-supervisor"
      criticality: "critical"
      auto_restart: true
      health_check: "/module-loaded"
      brain_integration: "required"

# ============================================================================
# HEALTH MONITORING CONFIGURATION
# ============================================================================
health_monitoring:
  # Continuous monitoring settings
  continuous_monitoring:
    enabled: true
    interval: 5s
    timeout: 3s
    parallel_checks: true
    
  # Health check endpoints
  endpoints:
    brain_health: "https://headyio.com/api/brain/health"
    manager_health: "https://headyio.com/api/health"
    conductor_health: "https://headyio.com/api/conductor/health"
    supervisor_health: "https://headyio.com/api/supervisor/module-loaded"
    
  # Health metrics to track
  metrics:
    - "response_time"
    - "availability_percentage"
    - "error_rate"
    - "throughput"
    - "resource_usage"
    - "brain_integration_status"
    
  # Alert thresholds
  alert_thresholds:
    response_time_p95: 1000ms
    availability_minimum: 99.9%
    error_rate_maximum: 0.1%
    brain_integration_failure: 0  # Zero tolerance

# ============================================================================
# AUTOMATIC RECOVERY MECHANISMS
# ============================================================================
auto_recovery:
  # Service restart policies
  restart_policies:
    heady_brain:
      max_restarts: 10
      restart_delay: 5s
      exponential_backoff: true
      max_backoff: 60s
      
    heady_manager:
      max_restarts: 5
      restart_delay: 10s
      exponential_backoff: true
      max_backoff: 120s
      
    other_services:
      max_restarts: 3
      restart_delay: 15s
      exponential_backoff: true
      max_backoff: 180s
      
  # Failover configuration
  failover:
    automatic_failover: true
    failover_delay: 2s
    health_check_before_failover: true
    restore_after_recovery: true
    
  # Emergency procedures
  emergency:
    enabled: true
    trigger_conditions:
      - "brain_unavailable_for_30s"
      - "multiple_services_down"
      - "critical_error_rate"
    emergency_actions:
      - "activate_backup_brain"
      - "restart_all_services"
      - "enable_maintenance_mode"
      - "notify_administrators"

# ============================================================================
# USAGE ENFORCEMENT
# ============================================================================
usage_enforcement:
  # Force all operations through HeadyBrain
  brain_first_policy:
    enabled: true
    description: "All operations must go through HeadyBrain first"
    exceptions: []
    
  # Block non-Heady services
  external_service_blocking:
    enabled: true
    allowed_external_services:
      - "render.com"  # For deployment
      - "github.com"  # For source control
      - "npmjs.com"   # For packages
    blocked_services:
      - "competing_ai_services"
      - "external_brain_services"
      - "unauthorized_apis"
      
  # Service routing rules
  routing_rules:
    - pattern: "*"
      destination: "heady_brain"
      priority: 1
      description: "Route everything to HeadyBrain first"
      
    - pattern: "deployment_*"
      destination: "heady_manager"
      priority: 2
      brain_approval: "required"
      
    - pattern: "code_*"
      destination: "heady_conductor"
      priority: 2
      brain_approval: "required"

# ============================================================================
# VALIDATION AND COMPLIANCE
# ============================================================================
validation:
  # Continuous validation
  continuous_validation:
    enabled: true
    interval: 30s
    strict_mode: true
    
  # Validation checks
  checks:
    - name: "brain_dominance_check"
      description: "Verify HeadyBrain is being used for all decisions"
      frequency: "continuous"
      failure_action: "immediate_correction"
      
    - name: "service_availability_check"
      description: "Verify all mandatory services are available"
      frequency: "continuous"
      failure_action: "auto_recovery"
      
    - name: "brain_integration_check"
      description: "Verify services are properly integrated with HeadyBrain"
      frequency: "continuous"
      failure_action: "reconfigure_service"
      
    - name: "usage_compliance_check"
      description: "Verify all operations use Heady services"
      frequency: "continuous"
      failure_action: "block_operation"

# ============================================================================
# LOGGING AND OBSERVABILITY
# ============================================================================
logging:
  # Comprehensive logging
  log_level: "debug"
  log_all_brain_operations: true
  log_service_interactions: true
  log_enforcement_actions: true
  
  # Log destinations
  destinations:
    - type: "file"
      path: "/var/log/heady/brain-dominance.log"
      rotation: "daily"
      retention: "30d"
    - type: "syslog"
      facility: "local0"
      priority: "info"
    - type: "cloud"
      service: "cloudwatch"
      namespace: "heady/brain-dominance"

# ============================================================================
# SECURITY AND ACCESS CONTROL
# ============================================================================
security:
  # Brain access control
  brain_access:
    require_authentication: true
    require_authorization: true
    audit_all_access: true
    rate_limit:
      requests_per_minute: 1000
      burst: 100
      
  # Service communication security
  service_communication:
    require_mtls: true
    encrypt_all_communication: true
    verify_service_identity: true
    
  # Enforcement security
  enforcement_security:
    require_admin_override: true
    audit_all_overrides: true
    override_expiration: "24h"

# ============================================================================
# DYNAMIC INTELLIGENT PARALLEL RESOURCE ALLOCATION (DIPRA) INTEGRATION
# ============================================================================
dipra_integration:
  enabled: true
  config_path: "configs/dynamic-parallel-resource-allocation.yaml"
  brain_authority: supreme
  description: >
    HeadyBrain directs the DIPRA engine for all resource allocation decisions.
    Ensures 100% functional state across all Heady services at all times.
  
  brain_capabilities:
    - predictive_scaling
    - pattern_based_preallocation
    - anomaly_triggered_rebalance
    - deployment_aware_reservation
    - workload_priority_override
  
  enforcement:
    all_services_100_percent: true
    no_silent_degradation: true
    brain_cannot_disable_dipra: true
    audit_all_allocation_changes: true

# ============================================================================
# EMERGENCY OVERRIDES
# ============================================================================
emergency_overrides:
  # System administrator override capabilities
  admin_override:
    enabled: true
    require_multi_factor: true
    require_approval: true
    time_limit: "1h"
    audit_required: true
    
  # Emergency bypass procedures
  emergency_bypass:
    enabled: true
    trigger_conditions:
      - "system_wide_failure"
      - "security_incident"
      - "maintenance_window"
    bypass_duration: "30m"
    auto_restore: true
    notification_required: true
